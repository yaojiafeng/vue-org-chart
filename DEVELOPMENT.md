# å¼€å‘è°ƒè¯•æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç» `vue-org-chart` ç»„ä»¶çš„å¼€å‘è°ƒè¯•æµç¨‹å’Œæœ€ä½³å®è·µã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
vue-org-chart/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ org-chart/          # ç»„ä»¶åº“æºç 
â”‚   â”‚   â”œâ”€â”€ src/            # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ dist/           # æ„å»ºäº§ç‰©ï¼ˆå‘å¸ƒåˆ° npmï¼‰
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ demo/               # å¼€å‘è°ƒè¯•æ¼”ç¤ºé¡¹ç›®
â”‚       â”œâ”€â”€ src/
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ package.json            # æ ¹ package.jsonï¼ˆmonorepo ç®¡ç†ï¼‰
â””â”€â”€ pnpm-workspace.yaml     # pnpm workspace é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

è®¿é—® http://localhost:3000 æŸ¥çœ‹æ¼”ç¤ºé¡µé¢ã€‚

## ğŸ”§ å¼€å‘æ¨¡å¼è¯´æ˜

æœ¬é¡¹ç›®é‡‡ç”¨ **Monorepo + æºç ç›´æ¥å¼•ç”¨** çš„å¼€å‘æ¨¡å¼ï¼Œè¿™æ˜¯ç»„ä»¶åº“å¼€å‘çš„æœ€ä½³å®è·µã€‚

### å¼€å‘æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **æºç ç›´æ¥å¼•ç”¨**ï¼ˆå½“å‰ï¼‰ | âœ… ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆ<br>âœ… æ— éœ€æ„å»º<br>âœ… å¼€å‘æ•ˆç‡æœ€é«˜ | âš ï¸ éœ€è¦é…ç½® alias | **æ—¥å¸¸å¼€å‘ï¼ˆæ¨èï¼‰** |
| æ„å»ºäº§ç‰©å¼•ç”¨ | âœ… æ¥è¿‘çœŸå®ä½¿ç”¨åœºæ™¯ | âŒ éœ€è¦æ„å»º<br>âŒ ä¿®æ”¹éœ€é‡æ–°æ„å»º | å‘å¸ƒå‰éªŒè¯ |

### å·¥ä½œåŸç†

åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œ`demo` é¡¹ç›®é€šè¿‡ Vite çš„ `alias` é…ç½®ç›´æ¥å¼•ç”¨ `org-chart` çš„æºç ï¼š

```typescript
// packages/demo/vite.config.ts
resolve: {
  alias: {
    '@org-chart': resolve(__dirname, '../org-chart/src'),  // ç›´æ¥å¼•ç”¨æºç 
  }
}
```

è¿™æ ·ä¿®æ”¹ç»„ä»¶æºç åï¼Œdemo ä¼šç«‹å³çœ‹åˆ°æ•ˆæœï¼Œæ— éœ€é‡æ–°æ„å»ºã€‚

## ğŸ“ å¼€å‘æµç¨‹

### 1. æ—¥å¸¸å¼€å‘ï¼ˆä½¿ç”¨æºç ï¼‰

**æ¨èæ–¹å¼**ï¼šç›´æ¥è¿è¡Œ demoï¼Œä½¿ç”¨æºç è¿›è¡Œå¼€å‘ã€‚

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
pnpm dev
```

**ç‰¹ç‚¹**ï¼š
- âœ… ä¿®æ”¹ç»„ä»¶æºç  â†’ ç«‹å³åœ¨ demo ä¸­çœ‹åˆ°æ•ˆæœ
- âœ… æ”¯æŒ HMRï¼ˆçƒ­æ¨¡å—æ›¿æ¢ï¼‰
- âœ… æ— éœ€æ„å»ºï¼Œå¼€å‘æ•ˆç‡æœ€é«˜
- âœ… é€‚åˆæ—¥å¸¸å¼€å‘è°ƒè¯•

### 2. éªŒè¯æ„å»ºäº§ç‰©ï¼ˆå‘å¸ƒå‰å¿…åšï¼‰

åœ¨å‘å¸ƒåˆ° npm å‰ï¼Œ**å¿…é¡»éªŒè¯æ„å»ºäº§ç‰©æ˜¯å¦æ­£å¸¸å·¥ä½œ**ï¼Œå› ä¸ºç”¨æˆ·å®‰è£…åä½¿ç”¨çš„æ˜¯æ„å»ºåçš„ `dist` ç›®å½•ï¼Œè€Œä¸æ˜¯æºç ã€‚

#### æ­¥éª¤ 1ï¼šæ„å»ºç»„ä»¶åº“

```bash
# æ„å»ºç»„ä»¶åº“åˆ° dist ç›®å½•
pnpm build
```

#### æ­¥éª¤ 2ï¼šä½¿ç”¨æ„å»ºäº§ç‰©è¿è¡Œ demo

**æ–¹å¼ Aï¼šä½¿ç”¨ä¾¿æ·å‘½ä»¤ï¼ˆæ¨èï¼‰**

```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨ watch æ¨¡å¼æ„å»ºï¼ˆç›‘å¬æºç å˜åŒ–ï¼Œè‡ªåŠ¨é‡æ–°æ„å»ºï¼‰
pnpm --filter vue-org-chart dev

# ç»ˆç«¯2ï¼šä½¿ç”¨æ„å»ºäº§ç‰©è¿è¡Œ demoï¼ˆæ¨¡æ‹ŸçœŸå® npm å®‰è£…ï¼‰
pnpm dev:dist
```

**æ–¹å¼ Bï¼šæ‰‹åŠ¨æ“ä½œ**

1. å…ˆæ„å»ºä¸€æ¬¡ï¼š`pnpm build`
2. å¯åŠ¨ watch æ„å»ºï¼š`pnpm --filter vue-org-chart dev`
3. è¿è¡Œ demoï¼ˆä½¿ç”¨æ„å»ºäº§ç‰©ï¼‰ï¼š`pnpm dev:dist`

#### éªŒè¯æ£€æŸ¥æ¸…å•

è¿è¡Œ `pnpm dev:dist` åï¼Œè¯·æ£€æŸ¥ï¼š

- [ ] ç»„ä»¶æ˜¯å¦æ­£å¸¸æ¸²æŸ“
- [ ] æ ·å¼æ˜¯å¦æ­£ç¡®åŠ è½½
- [ ] TypeScript ç±»å‹æç¤ºæ˜¯å¦æ­£å¸¸
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- [ ] æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ
- [ ] äº‹ä»¶å›è°ƒæ˜¯å¦æ­£å¸¸è§¦å‘

### 3. ç¯å¢ƒå˜é‡è¯´æ˜

é¡¹ç›®é€šè¿‡ç¯å¢ƒå˜é‡ `USE_DIST` æ§åˆ¶ä½¿ç”¨æºç è¿˜æ˜¯æ„å»ºäº§ç‰©ï¼š

- **ä¸è®¾ç½®**ï¼ˆé»˜è®¤ï¼‰ï¼šä½¿ç”¨æºç  `packages/org-chart/src`
- **USE_DIST=true**ï¼šä½¿ç”¨æ„å»ºäº§ç‰© `packages/org-chart/dist`

```bash
# ä½¿ç”¨æºç ï¼ˆé»˜è®¤ï¼‰
pnpm dev

# ä½¿ç”¨æ„å»ºäº§ç‰©
pnpm dev:dist  # å†…éƒ¨è®¾ç½®äº† USE_DIST=true
```

## ğŸ“¦ å‘å¸ƒæµç¨‹

### 1. å¼€å‘å®Œæˆ

ç¡®ä¿ä»£ç å·²æäº¤åˆ° Gitï¼ŒåŠŸèƒ½æµ‹è¯•é€šè¿‡ã€‚

### 2. éªŒè¯æ„å»ºäº§ç‰©

```bash
# æ„å»ºå¹¶éªŒè¯
pnpm build
pnpm dev:dist  # åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œï¼ŒéªŒè¯æ„å»ºäº§ç‰©
```

### 3. æ›´æ–°ç‰ˆæœ¬å·

```bash
# åœ¨ packages/org-chart/package.json ä¸­æ›´æ–°ç‰ˆæœ¬å·
# ä¾‹å¦‚ï¼š1.0.0 -> 1.0.1
```

### 4. æ„å»ºå‘å¸ƒåŒ…

```bash
# æ¸…ç†æ—§çš„æ„å»ºäº§ç‰©
pnpm clean

# æ„å»ºç»„ä»¶åº“
pnpm build

# æ£€æŸ¥ dist ç›®å½•å†…å®¹
ls packages/org-chart/dist
```

### 5. å‘å¸ƒåˆ° npm

```bash
cd packages/org-chart
npm publish
```

æˆ–è€…ä½¿ç”¨ pnpmï¼š

```bash
pnpm --filter vue-org-chart publish
```

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### æ ¹ç›®å½•å‘½ä»¤

```bash
# å¼€å‘ï¼ˆä½¿ç”¨æºç ï¼‰
pnpm dev

# å¼€å‘ï¼ˆä½¿ç”¨æ„å»ºäº§ç‰©ï¼Œç”¨äºéªŒè¯ï¼‰
pnpm dev:dist

# æ„å»ºç»„ä»¶åº“
pnpm build

# æ„å»º demo
pnpm build:demo

# ç±»å‹æ£€æŸ¥
pnpm type-check

# ä»£ç æ£€æŸ¥
pnpm lint

# æ¸…ç†æ„å»ºäº§ç‰©
pnpm clean

# é¢„è§ˆæ„å»ºåçš„ demo
pnpm preview
```

### ç»„ä»¶åº“å‘½ä»¤ï¼ˆpackages/org-chartï¼‰

```bash
# æ„å»ºï¼ˆä¸€æ¬¡æ€§ï¼‰
pnpm --filter vue-org-chart build

# æ„å»ºï¼ˆwatch æ¨¡å¼ï¼Œç›‘å¬å˜åŒ–ï¼‰
pnpm --filter vue-org-chart dev

# ç±»å‹æ£€æŸ¥
pnpm --filter vue-org-chart type-check

# ä»£ç æ£€æŸ¥
pnpm --filter vue-org-chart lint

# æ¸…ç†
pnpm --filter vue-org-chart clean
```

### Demo å‘½ä»¤ï¼ˆpackages/demoï¼‰

```bash
# å¼€å‘ï¼ˆä½¿ç”¨æºç ï¼‰
pnpm --filter vue-org-chart-demo dev

# å¼€å‘ï¼ˆä½¿ç”¨æ„å»ºäº§ç‰©ï¼‰
pnpm --filter vue-org-chart-demo dev:dist

# æ„å»º
pnpm --filter vue-org-chart-demo build

# é¢„è§ˆ
pnpm --filter vue-org-chart-demo preview
```

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆå¼€å‘æ—¶ä½¿ç”¨æºç ï¼Œå‘å¸ƒå‰è¦éªŒè¯æ„å»ºäº§ç‰©ï¼Ÿ

**A**: 
- å¼€å‘æ—¶ä½¿ç”¨æºç ï¼šå¼€å‘æ•ˆç‡é«˜ï¼Œä¿®æ”¹ç«‹å³ç”Ÿæ•ˆ
- å‘å¸ƒåç”¨æˆ·ä½¿ç”¨æ„å»ºäº§ç‰©ï¼šç”¨æˆ·é€šè¿‡ `npm install` å®‰è£…çš„æ˜¯æ„å»ºåçš„ `dist` ç›®å½•
- ä¸¤è€…å¯èƒ½ä¸ä¸€è‡´ï¼šæ„å»ºé…ç½®é”™è¯¯ã€ç±»å‹å®šä¹‰ç¼ºå¤±ç­‰é—®é¢˜åªæœ‰åœ¨ä½¿ç”¨æ„å»ºäº§ç‰©æ—¶æ‰èƒ½å‘ç°

### Q2: ä¿®æ”¹ç»„ä»¶å demo æ²¡æœ‰æ›´æ–°ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç¡®è®¤ä½¿ç”¨çš„æ˜¯ `pnpm dev`ï¼ˆä½¿ç”¨æºç ï¼‰ï¼Œè€Œä¸æ˜¯ `pnpm dev:dist`
2. æ£€æŸ¥ `packages/demo/vite.config.ts` ä¸­çš„ alias é…ç½®æ˜¯å¦æ­£ç¡®
3. é‡å¯å¼€å‘æœåŠ¡å™¨ï¼š`Ctrl+C` ç„¶åé‡æ–°è¿è¡Œ `pnpm dev`

### Q3: æ„å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: 
1. æ£€æŸ¥ TypeScript ç±»å‹é”™è¯¯ï¼š`pnpm type-check`
2. æ£€æŸ¥ä»£ç è§„èŒƒï¼š`pnpm lint`
3. æ¸…ç†åé‡æ–°æ„å»ºï¼š`pnpm clean && pnpm build`
4. æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„å…·ä½“é”™è¯¯ä¿¡æ¯

### Q4: å¦‚ä½•è°ƒè¯•æ„å»ºäº§ç‰©çš„é—®é¢˜ï¼Ÿ

**A**: 
1. ä½¿ç”¨ `pnpm dev:dist` è¿è¡Œ demoï¼ˆä½¿ç”¨æ„å»ºäº§ç‰©ï¼‰
2. åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
3. æ£€æŸ¥ `packages/org-chart/dist` ç›®å½•ä¸­çš„æ–‡ä»¶æ˜¯å¦å®Œæ•´
4. å¯¹æ¯”æºç å’Œæ„å»ºäº§ç‰©çš„å·®å¼‚

### Q5: ä¸ºä»€ä¹ˆéœ€è¦ watch æ¨¡å¼ï¼Ÿ

**A**: 
- åœ¨éªŒè¯æ„å»ºäº§ç‰©æ—¶ï¼Œå¦‚æœå‘ç°éœ€è¦ä¿®æ”¹æºç 
- watch æ¨¡å¼ä¼šè‡ªåŠ¨é‡æ–°æ„å»ºï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œ `pnpm build`
- æé«˜éªŒè¯æ•ˆç‡

## ğŸ” æŠ€æœ¯æ ˆ

- **åŒ…ç®¡ç†**: pnpm (workspace)
- **æ„å»ºå·¥å…·**: Vite
- **æ¡†æ¶**: Vue 3
- **è¯­è¨€**: TypeScript
- **ç±»å‹ç”Ÿæˆ**: vite-plugin-dts

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Vite æ–‡æ¡£](https://vitejs.dev/)
- [Vue 3 æ–‡æ¡£](https://vuejs.org/)
- [pnpm workspace æ–‡æ¡£](https://pnpm.io/workspaces)
- [TypeScript æ–‡æ¡£](https://www.typescriptlang.org/)

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ—¥å¸¸å¼€å‘**ï¼šå§‹ç»ˆä½¿ç”¨ `pnpm dev`ï¼ˆæºç æ¨¡å¼ï¼‰
2. **å‘å¸ƒå‰**ï¼šå¿…é¡»ä½¿ç”¨ `pnpm dev:dist` éªŒè¯æ„å»ºäº§ç‰©
3. **æäº¤å‰**ï¼šè¿è¡Œ `pnpm type-check` å’Œ `pnpm lint` ç¡®ä¿ä»£ç è´¨é‡
4. **ç‰ˆæœ¬ç®¡ç†**ï¼šéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰
5. **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿æ‰€æœ‰åŠŸèƒ½åœ¨æ„å»ºäº§ç‰©æ¨¡å¼ä¸‹æ­£å¸¸å·¥ä½œ

---

**æœ€åæ›´æ–°**: 2024å¹´

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹é¡¹ç›® Issues æˆ–æäº¤æ–°çš„ Issueã€‚

